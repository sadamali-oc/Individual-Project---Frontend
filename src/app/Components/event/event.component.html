<!-- ========================
     Search & Filter
======================== -->
<div class="search-filter-container">
  <mat-form-field appearance="outline" style="flex: 1 1 300px; min-width: 250px">
    <mat-label>Search Events</mat-label>
    <mat-icon matPrefix>search</mat-icon>
    <input matInput [(ngModel)]="searchTerm" placeholder="Enter event name" />
    <button
      mat-icon-button
      *ngIf="searchTerm"
      matSuffix
      aria-label="Clear"
      (click)="searchTerm = ''"
    >
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>

  <mat-form-field appearance="outline" style="width: 200px; min-width: 150px">
    <mat-label>Filter by Status</mat-label>
    <mat-select [(value)]="selectedStatus">
      <mat-option value="">All</mat-option>
      <mat-option value="pending">Pending</mat-option>
      <mat-option value="active">Active</mat-option>
    </mat-select>
  </mat-form-field>
</div>

<!-- ========================
     Event Cards
======================== -->
<div class="event-cards-container" *ngIf="filteredEvents.length > 0; else noEvents">
  <mat-card class="event-card" *ngFor="let event of filteredEvents">
    <mat-card-header>
      <mat-card-title>{{ event.event_name }}</mat-card-title>
    </mat-card-header>

    <img *ngIf="event.flyer_image" mat-card-image [src]="event.flyer_image" alt="Event Flyer" />

    <mat-card-content>
      <p><strong>Date:</strong> {{ event.event_date | date: 'fullDate' }}</p>
      <p><strong>Start Time:</strong> {{ event.start_time }}</p>
      <p><strong>End Time:</strong> {{ event.end_time }}</p>

      <!-- Status Chip -->
      <mat-chip-listbox>
        <mat-chip
          selected
          [ngClass]="{
            'chip-active': event.status === 'active',
            'chip-pending': event.status === 'pending',
            'chip-completed': event.status === 'completed'
          }"
        >
          {{ event.status | titlecase }}
        </mat-chip>
      </mat-chip-listbox>
    </mat-card-content>

    <mat-card-actions>
      <button mat-button class="view-details-button" (click)="viewDetails(event)">
        <mat-icon>visibility</mat-icon> View Details
      </button>

      <button mat-button color="primary" (click)="viewAttendees(event)">
        <mat-icon>groups</mat-icon> Attendees
      </button>

      <!-- Chat button without badge -->
      <button
        mat-button
        color="accent"
        (click)="openChat(event)"
        aria-label="Chat"
      >
        <mat-icon>chat</mat-icon> Chat
      </button>

      <button mat-icon-button aria-label="Delete event" (click)="deleteEvent(event)">
        <mat-icon>delete</mat-icon>
      </button>
    </mat-card-actions>
  </mat-card>
</div>

<!-- ========================
     No Events Template
======================== -->
<ng-template #noEvents>
  <div class="no-events-container">
    <p class="no-events-text">No events to display for the selected status.</p>
  </div>
</ng-template>
